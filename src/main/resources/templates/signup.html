<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>회원가입 페이지</title>
</head>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script>
    $(document).ready(function() {
        var token = $("meta[name='_csrf']").attr("content");
        var header = $("meta[name='_csrf_header']").attr("content");

        $("#signup_button").on('click', function() {
            $.ajax({
                url: "/signup",
                type: "POST",
                contentType: 'application/json',
                cache :false,
                data: JSON.stringify({
                    "loginId": $("#loginId").val(),
                    "password": $("#password").val(),
                    "userName" : $("#userName").val(),
                    "organization" : $("#organization").val(),
                    "userGroup" : $("#userGroup").val(),
                    "allowCode": $("#allowCode").val()
                }),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader(header, token);
                },
                success: function(result) {
                    console.log("성공" + JSON.stringify(result));
                        window.location.replace("/")
                },
                error: function(request, status, error) {
                    alert(JSON.stringify(request)+ ", " + JSON.stringify(status) + ", " + error);
                }
            });
        });
    });



</script>

<style>
    label {
        font-size: 11px;
        font-weight: bold;
        text-align: right;
    }

    input {
        display: block;
        font-size: 11px;
        padding: 4px 2px;
        border: solid 1px #aacfe4;
        width: 200px;
        margin: 2px 0 20px 10px;
    }
</style>

<body>
<h1>회원 가입</h1>
<hr>

<form th:action="@{/signup}" method="post">
    <label> 아이디 </label> <input type="text" id="loginId" name="loginId" placeholder="아이디">
    <label> 비밀번호 </label> <input type="password" id="password" name="password" placeholder="비밀번호">
    <label> 이름 </label> <input type="text" id="userName" name="userName" placeholder="이름">
    <label> 서비스 이용 기관 </label> <input type="text" id="organization" name="organization" placeholder="서비스 이용 기관">
    <label> 사용자 소속 </label> <input type="text" id="userGroup" name="userGroup" placeholder="사용자 소속">
    <label> 허가코드 </label> <input type="text" id="allowCode" name="allowCode" placeholder="허가 코드">
    <input id="signup_button" type="button" value="가입하기">가입하기</button>
</form>
</body>
</html>