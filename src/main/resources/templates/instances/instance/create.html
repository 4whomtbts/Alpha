<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
</head>
<body>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script>
    function indefinitelyUseOnChange(self) {
        if (self.checked) {
            $("#reserveHour").prop('disabled',true);
            $("#reserveHour").val("");
        } else {
            $("#reserveHour").prop('disabled',false);
        }
    }

</script>

<div>
    <h3>인스턴스 생성</h3>
    <p>인스턴스 정보 입력</p>
    <form th:action="@{/instances/instance}" th:object="${instance}" th:method="POST">
        <table border="1" width="750">
            <tr>
                <td>인스턴스 이름</td>
                <td style="border:none;">
                    <input type="text" th:field="*{instanceName}" placeholder="">
                </td>
            </tr>
            <tr>
                <td>사용시간(Hour)</td>
                <td style="border:none;">
                    <input id="reserveHour" type="text" th:field="*{reserveHour}" placeholder="(예시)15">
                </td>
                <td style='border:none;'>
                    <label><input onchange="indefinitelyUseOnChange(this)" type="checkbox" name="indefinitelyUse" th:field="*{indefinitelyUse}" th:checked="${indefinitelyUse}">무기한사용(허가필요)</label>
                </td>
            </tr>
            <tr>
                <td>사용목적</td>
                <td style="border:none;">
                    <input type="text" th:field="*{purpose}" placeholder="**대회 준비, **연구실 모델학습">
                </td>
            </tr>
            <tr>
                <td>이미지 선택</td>
                <td style='border:none;'>
                    <select id="testOrder" th:field="*{containerImageId}">
                        <option value=""> Docker 이미지를 선택하세요. </option>
                        <option th:each="image : ${containerImageList}" th:value="${image.containerImageId}" th:text="|${image.containerImageNickName} / ${image.containerImageDescription}|">

                        </option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>사용 GPU 선택</td>
                <td style='border:none;'>
                    <select id="gpuSelection" th:field="*{numberOfGpuToUse}">
                        <option value=""> 사용할 GPU의 개수 </option>
                        <option th:value="1" th:text="1"></option>
                        <option th:value="2" th:text="2"></option>
                        <option th:value="3" th:text="3"></option>
                        <option th:value="4" th:text="4"></option>
                        <option th:value="5" th:text="5"></option>
                        <option th:value="6" th:text="6"></option>
                        <option th:value="7" th:text="7"></option>
                        <option th:value="8" th:text="8"></option>
                    </select>
                </td>
                <td style='border:none;'>
                    <label><input type="checkbox" name="useGpuExclusively" th:field="*{useGpuExclusively}" th:checked="${useGpuExclusively}">독점적GPU사용</label>
                </td>
            </tr>
            <tr th:each="externalPort,status : *{externalPorts}">
                <td> 포트매핑 </td>
                <td>
                    <input type="text" th:field="*{externalPorts[__${status.index}__].tag}" placeholder="태그">
                    <input type="text" th:field="*{externalPorts[__${status.index}__].to}" placeholder="목적지포트">
                </td>
            </tr>
            <tr>
                <td style='border:none;'>
                    <button type="submit" name="addExternalPort">외부포트 추가</button>
                </td>
            </tr>

        </table>
        <button type="submit">생성</button>
    </form>
</div>
</body>
</html>